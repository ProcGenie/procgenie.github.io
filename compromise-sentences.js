!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):(e="undefined"!=typeof globalThis?globalThis:e||self).compromiseSentences=t()}(this,(function(){"use strict";var e={NounPhrase:{notA:["VerbPhrase","AdjectivePhrase"],color:"blue"},VerbPhrase:{notA:["AdjectivePhrase","NounPhrase"],color:"green"},AdjectivePhrase:{notA:["VerbPhrase","NounPhrase"],color:"magenta"},Subordinate:{notA:[]}};var t=function(e){e.match("#Noun").tag("NounPhrase"),e.match("#Verb").tag("VerbPhrase"),e.match("(this|that|those|these)").tag("NounPhrase"),e.match("#Adjective+ #NounPhrase").tagSafe("NounPhrase"),e.match("#NounPhrase #Adjective+").tagSafe("NounPhrase"),e.match("#Value #NounPhrase").tag("NounPhrase"),e.match("#Determiner #NounPhrase").tag("NounPhrase"),e.match("#Determiner #Adverb+? #Adjective+ #NounPhrase").tag("NounPhrase"),e.match("(many|most|all|one|some|plenty) of #NounPhrase").tag("NounPhrase"),e.match("such a #NounPhrase").tag("NounPhrase"),e.match("#VerbPhrase #Adverb+").tagSafe("VerbPhrase"),e.match("#Adverb+ #VerbPhrase").tagSafe("VerbPhrase"),e.match("#Auxiliary+ #VerbPhrase").tagSafe("VerbPhrase"),e.match("#VerbPhrase no").tagSafe("VerbPhrase"),e.match("not #VerbPhrase").tagSafe("VerbPhrase"),e.match("#VerbPhrase [that]",0).unTag("NounPhrase"),e.match("#VerbPhrase #Conjunction #VerbPhrase").tagSafe("VerbPhrase"),e.match("(who|what|which)").tag("NounPhrase"),e.match("#Adverb+ #Adjective").tagSafe("AdjectivePhrase"),e.match("#Adjective").tagSafe("AdjectivePhrase"),e.match("#Value").tagSafe("NounPhrase"),e.match("#Date").tagSafe("NounPhrase"),e.match("#Date at #Date").tagSafe("NounPhrase")},r={prepend:function(e){return this.forEach((t=>{let r=t.match("^.");r.not("#ProperNoun").toLowerCase(),r._prepend(e),r.terms(0).toTitleCase()})),this},append:function(e){let t=/[.?!]\s*$/.test(e);return this.forEach((r=>{let s=r.match(".$"),o=s.termList(0),n=o.post;!0===t&&(n=""),s._append(e+n),o.post=" "})),this}};var s=function(e){let t=e.clone(!0);return 1===t.length?t:(t=t.if("#Verb"),1===t.length?t:(t=t.ifNo("(after|although|as|because|before|if|since|than|that|though|when|whenever|where|whereas|wherever|whether|while|why|unless|until|once)"),t=t.ifNo("^even (if|though)"),t=t.ifNo("^so that"),t=t.ifNo("^rather than"),t=t.ifNo("^provided that"),1===t.length?t:(t=t.ifNo("(that|which|whichever|who|whoever|whom|whose|whomever)"),1===t.length?t:(t=t.ifNo("(despite|during|before|through|throughout)"),1===t.length?t:(0===t.length&&(t=e),t.eq(0))))))};var o=function(e){let t=e.clauses(),r=s(t),o=r.match("#Determiner? (#Noun|#Adjective)+").if("#Noun"),n=r.verbs().eq(0);return{subject:o.eq(0),verb:n,object:n.lookAhead(".*")}},n={json:function(e){let t=null;"number"==typeof e&&(t=e,e=null),e=e||{text:!0,normal:!0,trim:!0,terms:!0};let r=[];return this.forEach((t=>{let s=t._json(e)[0],n=o(t);s.subject=n.subject.json(e)[0],s.verb=n.verb.json(e)[0],s.object=n.object.json(e)[0],r.push(s)})),null!==t?r[t]:r}},a={toNegative:function(){return this.forEach((e=>{let t=o(e),r=t.verb.clone();r=r.verbs().toNegative(),t.verb.replaceWith(r,!1)})),this},toPositive:function(){return this.forEach((e=>{let t=o(e),r=t.verb.clone();r=r.verbs().toPositive(),t.verb.replaceWith(r,!1)})),this}};var h=function(e){let t=e.post(),r=e.clauses();return!0===/\?/.test(t)||!/\.\.$/.test(e.out("text"))&&((!e.has("^#QuestionWord")||!e.has("#Comma"))&&(!!e.has("^#QuestionWord")||(!!e.has("^(do|does|did|is|was|can|could|will|would|may) #Noun")||(!!e.has("^(have|must) you")||(!!r.has("^#QuestionWord")||!!r.has("(do|does|is|was) #Noun+ #Adverb? (#Adjective|#Infinitive)$"))))))},i={isQuestion:function(){return this.filter((e=>h(e)))},isExclamation:function(){return this.filter((e=>e.lastTerm().termList(0).hasPost("!")))},isStatement:function(){return this.filter((e=>{let t=e.lastTerm().termList(0);return!t.hasPost("?")&&!t.hasPost("!")}))},toExclamation:function(){return this.post("!"),this},toQuestion:function(){return this.post("?"),this},toStatement:function(){return this.post("."),this}};var c={toPastTense:function(){return this.forEach((e=>{if(e.has("#PastTense"))return;let t=o(e),r=t.verb.clone();if(!function(e){return!!e.has("(could|should|would|may|can|must)")}(r)?(r=r.verbs().toPastTense(),t.verb.replaceWith(r,!1)):(r=r.verbs().toParticiple(),t.verb.replaceWith(r,!1)),t.object&&t.object.found&&t.object.has("#PresentTense")){let e=t.object.verbs();e=e.filter((e=>!e.lookBehind("to$").found)),e.if("#PresentTense").notIf("#Gerund").verbs().toPastTense()}})),this},toParticiple:function(){return this.forEach((e=>{if(e.has("has #Participle"))return;let t=o(e),r=t.verb.clone();if(r=r.verbs().toParticiple(),t.verb.replaceWith(r,!1),t.object&&t.object.found&&t.object.has("#PresentTense")){t.object.verbs().if("#PresentTense").verbs().toParticiple()}})),this},toPresentTense:function(){return this.forEach((e=>{let t=o(e),r=t.verb.lookBehind("(i|we) (#Adverb|#Verb)?$").found,s=t.verb.clone();if(s=r?s.has("(is|was|am|be)")?s.replace("will? (is|was|am|be)","am"):s.verbs().toInfinitive():s.verbs().toPresentTense(),t.verb.replaceWith(s,!1),t.object&&t.object.found&&t.object.has("#PastTense")){t.object.verbs().if("#PastTense").notIf("#Gerund").verbs().toPresentTense()}})),this},toFutureTense:function(){return this.forEach((e=>{let t=o(e),r=t.verb.clone();if(r=r.verbs().toFutureTense(),t.verb.replaceWith(r,!1),t.object&&t.object.found&&t.object.has("(#PastTense|#PresentTense)")){let e=t.object.verbs();e=e.if("(#PastTense|#PresentTense)").notIf("#Gerund"),e.forEach((e=>{!0===e.lookBehind("(that|which|who|whom)$").found?e.verbs().toPresentTense():e.verbs().toInfinitive()}))}})),this},subjects:function(){return this.map((e=>o(e).subject))},isPassive:function(){return this.if("was #Adverb? #PastTense #Adverb? by")}},u={phrases:function(){let e=[];return this.forEach((t=>{t=(t=(t=t.splitOn("#VerbPhrase+")).splitOn("#NounPhrase+")).splitOn("#AdjectivePhrase+"),e=e.concat(t.list)})),this.buildFrom(e)}};const l=Object.assign({},r,n,a,i,c,u);return function(r,s){s.addTags(e),s.postProcess(t);class o extends r{constructor(e,t,r){super(e=e.map((e=>e.clone(!0))),t,r)}}return l.questions=l.isQuestion,l.exclamations=l.isExclamation,l.statements=l.isStatement,l._prepend=o.prototype.prepend,l._append=o.prototype.append,l._json=o.prototype.json,Object.assign(o.prototype,l),o.prototype.buildFrom=function(e){return e=e.map((e=>e.clone(!0))),new o(e,this,this.world)},o.prototype.toDoc=function(){return r.prototype.buildFrom(this.list)},r.prototype.sentences=function(e){let t=[];this.list.forEach((e=>{t.push(e.fullSentence())}));let r=new o(t,this,this.world);return"number"==typeof e&&(r=r.get(e)),r},r}}));
